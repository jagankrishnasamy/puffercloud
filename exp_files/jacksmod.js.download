//(function () {
  /*
  var noconflict = { loader: {} };
  if (window.jacksmod)
  {
    noconflict = window.jacksmod;
  }
  window.jacksmod = {
    loader: { complete: {}, initFunctions: [] },
    noconflict: noconflict,
    common: {}
  };
  */
  if (window.jacksmod === undefined)
  {
    window.jacksmod = {
      loader: { complete: {}, initFunctions: [] },
      common: {},
      thumb: {}
    };
  }
  var $j = window.jacksmod;

  $j.loader.params = $j.loader.params || {};
  $j.loader.basePath = $j.loader.basePath ||
    'https://www.emulab.net/protogeni/jacksmod/stable/';
  $j.loader.baseUrl = $j.loader.baseUrl ||
    'https://www.emulab.net/protogeni/jacksmod/stable/';

/*
  $j.loader.loadScript = function (relPath) {
    if ($j.loader.complete[relPath] === undefined)
    {
      var script = document.createElement('script');
      script.src = this.basePath + relPath;
      script.type = 'application/javascript';
      script.async = false;
      script.defer = false;
      document.getElementsByTagName('head')[0].appendChild(script);
      $j.loader.complete[relPath] = 1;
    }
  };
*/

  $j.loader.loadStyle = function (relPath) {
    if ($j.loader.complete[relPath] === undefined)
    {
      var link = document.createElement('link');
      link.type = 'text/css';
      link.rel = 'stylesheet';
      link.href = this.basePath + relPath;
      document.getElementsByTagName('head')[0].appendChild(link);
      $j.loader.complete[relPath] = 1;
    }
  };
/*
  $j.loader.register = function (f) {
    $j.loader.initFunctions.push(f);
  };
*/
/*
  $j.loader.prefixPaths = function (libs, modules, templates) {
    var result = {};
    for (key in libs)
    {
      if (libs.hasOwnProperty(key))
      {
	result[key] = this.basePath + libs[key];
      }
    }
    var i = 0;
    for (i = 0; i < modules.length; i += 1)
    {
      result[modules[i]] = this.basePath + modules[i];
    }
    for (i = 0; i < templates.length; i += 1)
    {
      result[templates[i]] = 'text!' + this.basePath + templates[i];
    }
    console.dir(result);
    return result;
  };
*/
  var sourceOptionList = ['local', 'locals', 'devel', 'stable', 'utah', 'none'];

  var sourceOptions = {
    'local': 'http://localhost:8080/',
    'locals': 'https://localhost:8080/',
    'devel': 'https://www.emulab.net/protogeni/jacksmod/stable/',
    'stable': 'https://www.emulab.net/protogeni/jacksmod/stable/',
    'utah': 'https://www.emulab.net/protogeni/jacksmod/utah/',
    'none': './'
  };

  function getQueryParams(qs) {
    qs = qs.split('+').join(' ');
    var params = {};
    var re = /[?&]?([^=]+)=([^&]*)/g;
    var tokens = re.exec(qs);
    
    while (tokens) {
      params[decodeURIComponent(tokens[1])]
        = decodeURIComponent(tokens[2]);
      tokens = re.exec(qs);
    }
    
    return params;
  }

  var params = getQueryParams(window.location.search);
  if (params.source)
  {
    $j.loader.params.source = params.source;
  }

  var sourceName = $j.loader.params['source'];
  if (sourceOptionList.indexOf(sourceName) !== -1)
  {
    $j.loader.basePath = sourceOptions[sourceName];
    if (sourceName === 'none')
    {
      $j.loader.baseUrl = './';
    }
    else
    {
      $j.loader.baseUrl = sourceOptions[sourceName];
    }
  }
/*
  window.Jacks = window.Jacks || function (context) {
    var that = this;
    if (window.JACKS_LOADER.isReady)
    {
      instantiate();
    }
    else
    {
      that.isReady = false;
      window.JACKS_LOADER.onReady = instantiate;
    }

    function instantiate()
    {
      that.context = context;
      that.instance = new JACKS_LOADER.MainClass(context);
      that.isReady = true;
      if (that.context.readyCallback)
      {
	that.context.readyCallback(that.instance.updateIn,
				   that.instance.updateOut);
      }
    }
  };
*/
//  $j.loader.loadScript('common/loadbase.js');

//})();
